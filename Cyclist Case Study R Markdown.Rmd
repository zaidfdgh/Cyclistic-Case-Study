---
title: "Cyclistic Case Study"
output: 
  html_document:
    toc: true
    toc_float: true
    theme: flatly
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

This case study is the capstone project of the Google Data Analytics course. The capstone brings everything I've learned together.

#### 🚲 **How Does a Bike-Share Navigate Speedy Success?**

In this case study, I work for a fictional company called **Cyclistic**, a bike-share service based in Chicago. As a junior data analyst on the team, my role is to help uncover how casual riders and annual members use Cyclistic bikes differently. The goal is to develop a marketing strategy that encourages casual riders to become annual members. Since the executive team must approve the final plan, it needs to be backed by strong data insights and compelling visuals.

**Guiding Question:**
*How do annual members and casual riders use Cyclistic bikes differently?*

#### 🧹 **Data Cleaning and Organization**

I used the dataset provided in the course: **Divvy_Trips_2019_Q1**. This is a fictional dataset created for educational purposes, so its source and credibility cannot be verified. Fortunately, the data was mostly clean—there were no missing values or duplicates in the columns relevant to my analysis.

#### ♻ **Data Processing and Analysis**

Following the case study steps, I created several new columns:

`ride_length`: Calculates the duration of each ride in HH:MM:SS format by subtracting `start_time` from `end_time`.

`day_of_week`: Assigns a numeric value to each day (1 for Sunday through 7 for Saturday).

`day_of_week_str`: Converts the numeric day into its name (e.g., "Monday").

#### 📊 **Data Visualization**

I used RStudio to visualize the data and generate insights. First, I installed and loaded the necessary packages:

``` {r install-and-load-packages}
if (!require("tidyverse")) {
  options(repos = c(CRAN = "https://cloud.r-project.org"))
  install.packages("tidyverse")
}

if (!require("ggplot2")) {
  options(repos = c(CRAN = "https://cloud.r-project.org"))
  install.packages("ggplot2")
}

if (!require("plotly")) {
  options(repos = c(CRAN = "https://cloud.r-project.org"))
  install.packages("plotly")
}

library(tidyverse)
library(ggplot2)
library(plotly)
library(readxl)
library(scales)
```

Then, I imported the dataset from Excel:

``` {r import-data, cache=TRUE}
Divvy_Trips_2019_Q1 <- read_excel("C:/Users/User/OneDrive/Desktop/Cyclists Case Study/XLS/Divvy_Trips_2019_Q1.xlsx")
```

👥 **Trips by User Type and Gender**

``` {r max-user-count}
max_user <- Divvy_Trips_2019_Q1 %>%
  count(usertype, gender) %>%
  filter(!is.na(gender)) %>%
  pull(n) %>%
  max()
```

``` {r usertype-gender-plot}
user_plot <- Divvy_Trips_2019_Q1 %>%
  filter(!is.na(gender)) %>%
  ggplot(aes(x= usertype, fill = gender)) +
  geom_bar(position = "dodge") +
  scale_y_continuous(labels = label_comma()) +
  labs(
    title = "Trips by User Type and Gender",
    x = "User Type",
    y = "Number of Trips",
    fill = "Gender"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold"),
    plot.subtitle = element_text(hjust = 1),
    axis.title.x = element_text(margin = margin(t = 15)),
    axis.title.y = element_text(margin = margin(r = 15))
  )

ggplotly(user_plot)
```

📅 **Trips by Day of the Week**

``` {r max-day-count}
max_day <- Divvy_Trips_2019_Q1 %>%
  count(day_of_week_str) %>%
  pull(n) %>%
  max()
```

``` {r day-of-week-plot}
day_plot <- ggplot(Divvy_Trips_2019_Q1, aes(x = day_of_week_str)) +
  geom_bar(fill = "dark green") + 
  labs (
    title = "Trips by Day of the Week",
    x = "Day of the Week",
    y = "Number of Trips"
  ) +
  theme_minimal() +
  theme (
    plot.title = element_text(hjust = 0.5, face = "bold"),
    plot.subtitle = element_text(hjust = 1),
    axis.title.x = element_text(margin = margin(t = 15)),
    axis.title.y = element_text(margin = margin(r = 15))
  )

ggplotly(day_plot)
```

🎂 **Trips by Birth Year**

``` {r birthyear-plot}
max_year <- Divvy_Trips_2019_Q1 %>%
  filter(!is.na(birthyear)) %>%
  count(birthyear) %>%
  pull(n) %>%
  max()

top_year <- Divvy_Trips_2019_Q1 %>%
  filter(!is.na(birthyear)) %>%
  count(birthyear) %>%
  slice_max(n, n = 1) %>%
  pull(birthyear)

year_plot <- ggplot(Divvy_Trips_2019_Q1, aes(x = birthyear)) +
  geom_bar(fill = "dark blue") +
  scale_x_continuous(limits = c(1940, 2000)) +
  labs (
  title = "Trips by Birth Year",
  x = "Birth Year",
  y = "Number of Trips"
  ) +
  theme_minimal() +
  theme (
  plot.title = element_text(hjust = 0.5, face = "bold"),
  plot.subtitle = element_text(hjust = 0.85),
  axis.title.x = element_text(margin = margin(t = 15)),
  axis.title.y = element_text(margin = margin(r = 15))
  )

ggplotly(year_plot)
```

#### 🔍 **Data Exploration Summary and Insights**

I also calculated summary statistics to better understand the dataset:

``` {r mean year}
mean_year <- Divvy_Trips_2019_Q1 %>%
  summarise(mean_year = mean(birthyear, na.rm = TRUE)) %>%
  pull(mean_year) %>%
  round()

current_year <- as.numeric(format(Sys.Date(), "%Y"))
mean_age <- current_year - mean_year
```

Here are some key insights:

1. The highest number of trips in a single day was **`r format(max_day, big.mark = ",")`**, occurring on **Thursday**.
2. The most frequent user type was **Male Subscribers**, with **`r format(max_user, big.mark = ",")`** trips.
3. The birth year with the most trips was **`r top_year`**, totaling **`r format(max_year, big.mark = ",")`** rides.
4. The average birth year of riders was **`r mean_year`**, which as of the year `r current_year` are `r mean_age` years old.
5. Analysis of the **Trips by User Type and Gender** plot reveals a significant different in trip volume between **Customers** and **Subscribers**, with **Subscribers** accounting for a significantly higher number of trips.